<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
        integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <title>Employees</title>
</head>
<script>
    function home() {
        window.location = "http://localhost:8080/project-1/manager/Mhome.html"
    }

    function empl() {
        console.log("empl() started");
        let userString = sessionStorage.getItem('currentUser');
        let currentUser = JSON.parse(userString);

        let xhr = new XMLHttpRequest();

        xhr.onreadystatechange = function () {
            console.log("Process");
            if (this.readyState === 4 && this.status === 200) {
                console.log("Success");
                document.getElementById("empl").innerHTML = this.responseText;
                console.log(this.responseText);
            }

            if (this.readyState === 4 && this.status === 204) {
                console.log("Failed");
                let childDiv = document.getElementById("empl");
                childDiv.textContent = "No employees found";
            }
        }

        xhr.open("GET", "http://localhost:8080/project-1/allempls");
        xhr.send();
    }
</script>

<body onload="empl()">
    <div class="jumbotron">
        <h1 id="welcome">You are logged in!</h1>
        <script>

            let welcome = document.getElementById('welcome');
            let userString = sessionStorage.getItem('currentUser');
            let currentUser = JSON.parse(userString);

            if (userString === null) {
                window.location = "http://localhost:8080/project-1/index.html"
            } else {
                console.log(currentUser);
                if (currentUser != null) {
                    welcome.innerHTML = "Welcome to your employees " + currentUser.username;
                }
            }
        </script>
     	<br><br>
        <button class="btn btn-primary" onclick="home()">GO BACK</button>
        <br><br><br>
        <div id="empl"></div>
    </div>
</body>

</html>